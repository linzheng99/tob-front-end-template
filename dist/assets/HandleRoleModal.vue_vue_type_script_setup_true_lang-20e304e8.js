import{u as L,F as A}from"./useForm-417a659a.js";import{M as N}from"./index-443f46b2.js";import{u as B,c as K,b as P}from"./index-fab1141e.js";import{e as S,f as o,j as V,J as $,Y as j,Z as q,$ as r,a8 as d,a5 as E,a3 as m,ap as H,bC as J,b4 as U}from"./index-d0818fe1.js";const Y={class:"border-base border-1px w-full max-h-400px"},Z=m("div",null,null,-1),Q=S({__name:"HandleRoleModal",props:{id:{}},emits:["success"],setup(p,{expose:f,emit:h}){const s=p,t=o(!1),i=o([]),_=o(),b=V(()=>s.id?"编辑角色":"新增角色"),n=o([]),[g,{setFieldsValue:u,validate:k}]=L({schemas:v()});$(()=>t.value,async e=>{if(e){const{id:a}=s;if(y(),a){const c=await P(a);u(c)}}else n.value=[]});function v(){return[{field:"name",component:"NInput",label:"角色名",componentProps:{placeholder:"请输入角色名"},rules:[{required:!0,message:"请输入角色名",trigger:["blur"]}]},{field:"remark",component:"NInput",label:"角色备注",componentProps:{placeholder:"请输入角色备注"}},{field:"menuIds",label:"菜单",slot:"menus",showLabel:!0,giProps:{span:4}}]}function w({option:e}){var a;return`${(a=e.meta)==null?void 0:a.title}`}async function R(e){await k();try{const{id:a}=s;a?await B(a,e):await K(e),h("success"),l()}catch(a){console.error(a)}}async function y(){i.value=await U()}function x(e){n.value=e,u({menuIds:e})}function C(){n.value=[]}function l(){t.value=!t.value}return f({toggleModal:l}),(e,a)=>{const c=J,F=A;return j(),q(H,null,[r(N,{ref_key:"modalRef",ref:_,title:b.value,footer:!1,show:t.value,onCancel:l},{default:d(()=>[r(F,{onRegister:E(g),onSubmit:R,onReset:C},{menus:d(({model:M,field:I})=>[m("div",Y,[r(c,{"key-field":"id","block-line":"",checkable:"","expand-on-click":"","default-expand-all":"",data:i.value,"checked-keys":M[I],"render-label":w,onUpdateCheckedKeys:x},null,8,["data","checked-keys"])])]),_:1},8,["onRegister"])]),_:1},8,["title","show"]),Z],64)}}});export{Q as _};
