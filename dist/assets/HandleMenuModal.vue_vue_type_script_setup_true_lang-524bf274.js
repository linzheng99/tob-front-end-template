import{u as R,F as k}from"./useForm-766e6f4b.js";import{M as V}from"./index-857d0e23.js";import{e as x,f as m,J as C,j as A,b4 as F,Y as B,a4 as T,a8 as G,$ as U,a5 as $,ar as j,b5 as H,b6 as J}from"./index-bf5d60c1.js";function Y(){return[{field:"type",component:"RadioGroupComp",label:"菜单类型",componentProps:{options:[{label:"目录",value:0},{label:"菜单",value:1},{label:"权限",value:2}],defaultValue:0,onUpdateValue:()=>{}},rules:[{type:"number",required:!0,message:"请选择菜单类型",trigger:["blur"]}]},{field:"orderNo",component:"NInputNumber",label:"排序号",componentProps:{showButton:!1}}]}const z=[{field:"title",component:"NInput",label:"权限名称",componentProps:{placeholder:"请输入权限名称"},rules:[{required:!0,message:"请输入权限名称",trigger:["blur"]}]},{field:"permission",component:"NInput",label:"权限",componentProps:{placeholder:"请输入权限"},rules:[{required:!0,message:"请输入权限",trigger:["blur"]}]}],g=[{field:"name",component:"NInput",label:"路由名称",componentProps:{placeholder:"请输入路由名称"},rules:[{required:!0,message:"请输入路由名称",trigger:["blur"]}]},{field:"path",component:"NInput",label:"菜单地址",componentProps:{placeholder:"请输入菜单地址",rules:[{required:!0,message:"请输入菜单地址",trigger:["blur"]}]}},{field:"component",component:"NInput",label:"组件",componentProps:{placeholder:"请输入路由组件 / 组件地址",rules:[{required:!0,message:"请输入路由组件 / 组件地址",trigger:["blur"]}]}},{field:"redirect",component:"NInput",label:"路由重定向",componentProps:{placeholder:"请输入路由重定向"}},{field:"title",component:"NInput",label:"菜单名称",componentProps:{placeholder:"请输入菜单名称"},rules:[{required:!0,message:"请输入菜单名称",trigger:["blur"]}]},{field:"icon",component:"NInput",label:"菜单图标",componentProps:{placeholder:"请输入菜单图标"}}],D=[{field:"name",component:"NInput",label:"路由名称",componentProps:{placeholder:"请输入路由名称"},rules:[{required:!0,message:"请输入路由名称",trigger:["blur"]}]},{field:"path",component:"NInput",label:"菜单地址",componentProps:{placeholder:"请输入菜单地址",rules:[{required:!0,message:"请输入菜单地址",trigger:["blur"]}]}},{field:"component",component:"NInput",label:"组件",componentProps:{placeholder:"请输入路由组件 / 组件地址",rules:[{required:!0,message:"请输入路由组件 / 组件地址",trigger:["blur"]}]}},{field:"title",component:"NInput",label:"菜单名称",componentProps:{placeholder:"请输入菜单名称"},rules:[{required:!0,message:"请输入菜单名称",trigger:["blur"]}]},{field:"icon",component:"NInput",label:"菜单图标",componentProps:{placeholder:"请输入菜单图标"}}];function E(u){let o;switch(u){case 0:o=g;break;case 1:o=D;break;case 2:o=z;break;default:o=[]}return o}const Q=x({__name:"HandleMenuModal",props:{id:{},type:{}},emits:["success"],setup(u,{expose:o,emit:b}){const a=u,h=b,l=m(!1),t=m({}),s=Y(),[P,{setFieldsValue:v,validate:I,setProps:y,restoreValidation:N}]=R({schemas:[...s,...g],gridProps:{cols:1,yGap:0}});C(()=>l.value,async e=>{e?(M(),await q()):t.value={}});const w=m(),S=A(()=>a.type==="edit"?"编辑菜单":"新增菜单");async function q(){const{id:e,type:r}=a;if(e!==void 0)if(r==="add")t.value={parentId:e};else{const{meta:n,type:p,...i}=await F(e);t.value={...i,type:p,title:n.title,icon:n.icon},d(p),v(t.value)}}function d(e){const r=E(e);y({schemas:[...s,...r]})}function M(){s[0].componentProps={...s[0].componentProps,onUpdateValue:e=>{d(e),N()}}}async function _(e){var r;await I();try{j(t.value,e),delete t.value.id;const{title:n,icon:p,...i}=t.value,f={...i,meta:{title:n,icon:p}};a.type==="add"?await H(f):a.id!==void 0&&await J(a.id,f),(r=window.$message)==null||r.success("操作成功"),h("success"),c()}catch(n){console.error("捕获到的错误:",n)}}function c(){l.value=!l.value}return o({toggleModal:c}),(e,r)=>(B(),T(V,{ref_key:"modalRef",ref:w,title:S.value,footer:!1,show:l.value,onCancel:c},{default:G(()=>[U(k,{onRegister:$(P),onSubmit:_},null,8,["onRegister"])]),_:1},8,["title","show"]))}});export{Q as _};
