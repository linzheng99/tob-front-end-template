import{u as _,F as R}from"./useForm-417a659a.js";import{M as k}from"./index-443f46b2.js";import{e as V,f as m,J as x,j as C,Y as A,a4 as F,a8 as B,$ as T,a5 as G,ar as U,b6 as $,b7 as j,b8 as H}from"./index-d0818fe1.js";function J(){return[{field:"type",component:"RadioGroupComp",label:"菜单类型",componentProps:{options:[{label:"目录",value:0},{label:"菜单",value:1},{label:"权限",value:2}],defaultValue:0,onUpdateValue:()=>{}},rules:[{type:"number",required:!0,message:"请选择菜单类型",trigger:["blur"]}]},{field:"orderNo",component:"NInputNumber",label:"排序号",componentProps:{showButton:!1}}]}const Y=[{field:"title",component:"NInput",label:"权限名称",componentProps:{placeholder:"请输入权限名称"},rules:[{required:!0,message:"请输入权限名称",trigger:["blur"]}]},{field:"permission",component:"NInput",label:"权限",componentProps:{placeholder:"请输入权限"},rules:[{required:!0,message:"请输入权限",trigger:["blur"]}]}],g=[{field:"name",component:"NInput",label:"路由名称",componentProps:{placeholder:"请输入路由名称"},rules:[{required:!0,message:"请输入路由名称",trigger:["blur"]}]},{field:"path",component:"NInput",label:"菜单地址",componentProps:{placeholder:"请输入菜单地址",rules:[{required:!0,message:"请输入菜单地址",trigger:["blur"]}]}},{field:"component",component:"NInput",label:"组件",componentProps:{placeholder:"请输入路由组件 / 组件地址",rules:[{required:!0,message:"请输入路由组件 / 组件地址",trigger:["blur"]}]}},{field:"redirect",component:"NInput",label:"路由重定向",componentProps:{placeholder:"请输入路由重定向"}},{field:"title",component:"NInput",label:"菜单名称",componentProps:{placeholder:"请输入菜单名称"},rules:[{required:!0,message:"请输入菜单名称",trigger:["blur"]}]},{field:"icon",component:"NInput",label:"菜单图标",componentProps:{placeholder:"请输入菜单图标"}}],z=[{field:"name",component:"NInput",label:"路由名称",componentProps:{placeholder:"请输入路由名称"},rules:[{required:!0,message:"请输入路由名称",trigger:["blur"]}]},{field:"path",component:"NInput",label:"菜单地址",componentProps:{placeholder:"请输入菜单地址",rules:[{required:!0,message:"请输入菜单地址",trigger:["blur"]}]}},{field:"component",component:"NInput",label:"组件",componentProps:{placeholder:"请输入路由组件 / 组件地址",rules:[{required:!0,message:"请输入路由组件 / 组件地址",trigger:["blur"]}]}},{field:"title",component:"NInput",label:"菜单名称",componentProps:{placeholder:"请输入菜单名称"},rules:[{required:!0,message:"请输入菜单名称",trigger:["blur"]}]},{field:"icon",component:"NInput",label:"菜单图标",componentProps:{placeholder:"请输入菜单图标"}}];function D(u){let o;switch(u){case 0:o=g;break;case 1:o=z;break;case 2:o=Y;break;default:o=[]}return o}const O=V({__name:"HandleMenuModal",props:{id:{},type:{}},emits:["success"],setup(u,{expose:o,emit:b}){const a=u,l=m(!1),t=m({}),s=J(),[h,{setFieldsValue:P,validate:v,setProps:I,restoreValidation:y}]=_({schemas:[...s,...g],gridProps:{cols:1,yGap:0}});x(()=>l.value,async e=>{e?(q(),await S()):t.value={}});const N=m(),w=C(()=>a.type==="edit"?"编辑菜单":"新增菜单");async function S(){const{id:e,type:r}=a;if(e!==void 0)if(r==="add")t.value={parentId:e};else{const{meta:n,type:p,...i}=await H(e);t.value={...i,type:p,title:n.title,icon:n.icon},d(p),P(t.value)}}function d(e){const r=D(e);I({schemas:[...s,...r]})}function q(){s[0].componentProps={...s[0].componentProps,onUpdateValue:e=>{d(e),y()}}}async function M(e){var r;await v();try{U(t.value,e),delete t.value.id;const{title:n,icon:p,...i}=t.value,f={...i,meta:{title:n,icon:p}};a.type==="add"?await $(f):a.id!==void 0&&await j(a.id,f),(r=window.$message)==null||r.success("操作成功"),b("success"),c()}catch(n){console.error("捕获到的错误:",n)}}function c(){l.value=!l.value}return o({toggleModal:c}),(e,r)=>(A(),F(k,{ref_key:"modalRef",ref:N,title:w.value,footer:!1,show:l.value,onCancel:c},{default:B(()=>[T(R,{onRegister:G(h),onSubmit:M},null,8,["onRegister"])]),_:1},8,["title","show"]))}});export{O as _};
