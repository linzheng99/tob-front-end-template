import{_ as k}from"./index.vue_vue_type_script_setup_true_lang-fb76c1e8.js";import{e as C,aK as v,f as i,ao as c,Y as x,Z as S,$ as E}from"./index-d0818fe1.js";import"./createPlaceholder-447273ac.js";const P={class:"h-full flex"},D=C({__name:"EditableTable",setup(R){v(()=>{g()});const r=i(),d=i(!1),o=i([]),u=i([{label:"男",value:1},{label:"女",value:2}]),m=c([{title:"序号",align:"center",key:"index",width:60,fixed:"left",render:(e,t)=>`${t+1}`},{title:"日期范围",key:"date",align:"center",width:250,editable:!0,labelKey:e=>`${e.date.join("-")}`,editComponent:"NDatePicker",editComponentProps:{type:"daterange",valueFormat:"yyyy-MM-dd"}},{title:"姓名",key:"name",align:"center",width:250,editable:!0},{title:"性别",key:"sex",labelKey:"sexStr",align:"center",width:250,editable:!0,editRule:!0,editComponent:"NSelect",editComponentProps:{options:u.value},editRenders:[{key:"",render({editValues:e}){return e.sex===1?"男":""}}]},{title:"年龄",key:"age",align:"center",width:250,editable:!0,editComponent:"NInput",editRule:async(e,t)=>{if(+e>18)throw new Error("请输入小于18的值");return!0}},{title:"地址",key:"address",align:"center",width:250,editable:!0}]);function p(e){const{record:t,index:a}=e;o.value[a].sexStr=t.sex===1?"男":"女"}function f(e){o.value=e}function y(e){const{record:t,key:a}=e;console.warn(t,a)}const h=c({key:"_action",title:"操作",align:"center",fixed:"right",width:200,actions:e=>_(e)});async function b(e){var n,s,l;const{record:t,title:a}=e;switch(a){case"编辑":await((n=t.onEdit)==null?void 0:n.call(t,!0));break;case"保存":await((s=t.onSubmitEdit)==null?void 0:s.call(t));break;case"取消":(l=t.onCancelEdit)==null||l.call(t);break}}async function g(){var e;try{await((e=r.value)==null?void 0:e.reloadData())}catch(t){console.error(t)}}function _(e){const t=e.editable;return[{iconConfig:{icon:"ep-search"},title:e.editable?"保存":"编辑",componentProps:{type:"primary",disabled:d.value}},{show:!!t,iconConfig:{icon:"ep-search"},title:"取消",componentProps:{type:"primary"}}]}function w(){return new Promise(e=>{setTimeout(()=>{const t=Array.from({length:9}).map((a,n)=>({name:`name - ${n}`,sex:n%2?1:2,sexStr:n%2?"男":"女",age:18,address:`address - ${n}`,date:["2024-02-09","2024-02-10"]}));e({items:t,currentPage:1,totalItems:t.length,totalPages:t.length/10})},1e3)})}return(e,t)=>(x(),S("div",P,[E(k,{ref_key:"tableRef",ref:r,data:o.value,columns:m,"request-api":w,"action-column":h,onRequestSuccess:f,onHandleAction:b,onEditSubmit:p,onEditChange:y},null,8,["data","columns","action-column"])]))}});export{D as default};
