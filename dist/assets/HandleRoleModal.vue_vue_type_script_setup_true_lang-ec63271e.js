import{u as L,F as N}from"./useForm-766e6f4b.js";import{M as B}from"./index-857d0e23.js";import{b as K,u as P,c as S}from"./index-b1d7b574.js";import{e as V,f as o,j as $,J as j,b2 as q,Y as E,Z as H,$ as c,a8 as d,a5 as J,a3 as m,ap as U,bA as Y}from"./index-bf5d60c1.js";const Z={class:"border-base border-1px w-full max-h-400px"},Q=V({__name:"HandleRoleModal",props:{id:{}},emits:["success"],setup(p,{expose:f,emit:h}){const s=p,_=h,a=o(!1),i=o([]),b=o(),g=$(()=>s.id?"编辑角色":"新增角色"),n=o([]),[k,{setFieldsValue:u,validate:v}]=L({schemas:w()});j(()=>a.value,async t=>{if(t){const{id:e}=s;if(x(),e){const r=await K(e);u(r)}}else n.value=[]});function w(){return[{field:"name",component:"NInput",label:"角色名",componentProps:{placeholder:"请输入角色名"},rules:[{required:!0,message:"请输入角色名",trigger:["blur"]}]},{field:"remark",component:"NInput",label:"角色备注",componentProps:{placeholder:"请输入角色备注"}},{field:"menuIds",label:"菜单",slot:"menus",showLabel:!0,giProps:{span:4}}]}function R({option:t}){var e;return`${(e=t.meta)==null?void 0:e.title}`}async function y(t){await v();try{const{id:e}=s;e?await P(e,t):await S(t),_("success"),l()}catch(e){console.error(e)}}async function x(){i.value=await q()}function F(t){n.value=t,u({menuIds:t})}function M(){n.value=[]}function l(){a.value=!a.value}return f({toggleModal:l}),(t,e)=>{const r=Y,C=N;return E(),H(U,null,[c(B,{ref_key:"modalRef",ref:b,title:g.value,footer:!1,show:a.value,onCancel:l},{default:d(()=>[c(C,{onRegister:J(k),onSubmit:y,onReset:M},{menus:d(({model:A,field:I})=>[m("div",Z,[c(r,{"key-field":"id","block-line":"",checkable:"","expand-on-click":"","default-expand-all":"",data:i.value,"checked-keys":A[I],"render-label":R,onUpdateCheckedKeys:F},null,8,["data","checked-keys"])])]),_:1},8,["onRegister"])]),_:1},8,["title","show"]),e[0]||(e[0]=m("div",null,null,-1))],64)}}});export{Q as _};
